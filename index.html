<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Plataforma Integrada</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: sans-serif; }
    body { display: flex; height: 100vh; background: #0f172a; color: white; margin: 0; }
    .sidebar { width: 240px; background: #1e293b; border-right: 1px solid #334155; display: flex; flex-direction: column; }
    .btn { padding: 15px; border: none; background: none; color: #94a3b8; text-align: left; cursor: pointer; border-bottom: 1px solid #334155; }
    .btn:hover { background: #334155; color: white; }
    .btn.active { border-left: 4px solid #f97316; color: #f97316; background: #1e293b; }
    .main { flex: 1; background: #f1f5f9; position: relative; }
    iframe { width: 100%; height: 100%; border: none; display: none; }
    .error-msg { display: none; color: #ef4444; padding: 20px; text-align: center; }
  </style>
</head>
<body>

  <div class="sidebar">
    <div style="padding:20px; font-weight:bold; color:#f97316; text-align:center;">MENU PRINCIPAL</div>
    
    <button class="btn" onclick="forcarAbrir('controle de cobranÃ§a.html', this)">ðŸ’° CobranÃ§a</button>
    <button class="btn" onclick="forcarAbrir('teste.html.html', this)">ðŸ“Š Financeiro</button>
    <button class="btn" onclick="forcarAbrir('gerador_relatorios.html', this)">ðŸ“ˆ RelatÃ³rios</button>
  </div>

  <div class="main">
    <div id="loading" style="display:none; color:#64748b; padding:20px;">Carregando sistema...</div>
    <iframe id="app-frame" onload="document.getElementById('loading').style.display='none'"></iframe>
  </div>

  <script>
    function forcarAbrir(arquivo, elemento) {
      const frame = document.getElementById("app-frame");
      const loading = document.getElementById("loading");
      
      // EstÃ©tica do botÃ£o
      document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
      elemento.classList.add('active');
      
      loading.style.display = "block";
      frame.style.display = "block";

      // O segredo: ForÃ§amos o caminho absoluto baseado na URL atual para evitar erro de subpasta
      const currentPath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));
      const urlFinal = window.location.origin + currentPath + "/" + arquivo;
      
      console.log("Tentando abrir:", urlFinal);
      frame.src = urlFinal;
    }

    // ComunicaÃ§Ã£o de dados (Ponte)
    let bancoDados = null;
    window.addEventListener("message", (e) => {
      if (e.data.type === "DATA_TRANSFER") bancoDados = e.data.payload;
      if (e.data.type === "REQUEST_DATA" && bancoDados) {
        document.getElementById("app-frame").contentWindow.postMessage({
          type: "FILL_REPORT",
          payload: bancoDados
        }, "*");
      }
    });
  </script>
</body>
</html>
